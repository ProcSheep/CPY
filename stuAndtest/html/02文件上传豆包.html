<!DOCTYPE html>
<html>

<head>
  <title>拖拽文件夹示例</title>
  <style>
    #dropArea {
      width: 300px;
      height: 200px;
      border: 2px dashed #ccc;
      text-align: center;
      line-height: 200px;
      font-family: Arial;
    }

    #dropArea.active {
      border-color: #333;
      background-color: #f0f0f0;
    }
  </style>
</head>

<body>
  <div id="dropArea">拖拽文件夹到这里</div>

  <script>
    const dropArea = document.getElementById('dropArea');

    // 阻止默认拖拽行为（否则浏览器会直接打开文件）
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, preventDefaults, false);
      document.body.addEventListener(eventName, preventDefaults, false);
    });

    // 高亮拖拽区域
    ['dragenter', 'dragover'].forEach(eventName => {
      dropArea.addEventListener(eventName, highlight, false);
    });

    // 移除高亮
    ['dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, unhighlight, false);
    });

    // 处理文件掉落
    dropArea.addEventListener('drop', handleDrop, false);

    function preventDefaults(e) {
      e.preventDefault();
      e.stopPropagation();
    }

    function highlight() {
      dropArea.classList.add('active');
    }

    function unhighlight() {
      dropArea.classList.remove('active');
    }

    function handleDrop(e) {
      const dt = e.dataTransfer;
      const items = dt.items;

      // 遍历所有拖拽项
      for (let i = 0; i < items.length; i++) {
        const item = items[i];
        // 检查是否为文件夹（webkitGetAsEntry 是 Chrome 等浏览器的实现）
        if (item.kind === 'file') {
          const entry = item.webkitGetAsEntry();
          if (entry) {
            traverseFileTree(entry); // 递归处理文件夹
          }
        }
      }
    }

    // 递归遍历文件夹中的所有文件
    function traverseFileTree(entry) {
      if (entry.isFile) {
        // 如果是文件，读取并打印信息
        entry.file(file => {
          console.log('文件信息：', {
            name: file.name,
            size: file.size,
            type: file.type,
            lastModified: new Date(file.lastModified)
          });
        });
      } else if (entry.isDirectory) {
        // 如果是文件夹，继续遍历子项
        const reader = entry.createReader();
        reader.readEntries(entries => {
          entries.forEach(entry => traverseFileTree(entry));
        });
      }
    }
  </script>
</body>

</html>